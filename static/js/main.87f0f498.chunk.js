(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,n){},41:function(e,t,n){e.exports=n(98)},45:function(e,t,n){},46:function(e,t,n){e.exports=n.p+"static/media/logo.43f13564.svg"},98:function(e,t,n){"use strict";n.r(t);var o=n(4),i=n.n(o),r=n(38),a=n.n(r),c=(n(45),n(46),n(19),n(13)),s=n(8),l=n.n(s),u=n(17),f=n(10),h=n(11),d=n(14),p=n(12),m=n(15);function g(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}var v=n(39),y=n.n(v),_=n(40),E=n(25),b=n.n(E),w=.2,x=100,O=x,k=function(){var e=Object(u.a)(l.a.mark(function e(t,n){var o,i,r=arguments;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=r.length>2&&void 0!==r[2]?r[2]:0,i=0;case 2:if(!(i<n)){e.next=10;break}return console.log("%cTIME_STEP: ".concat(i),"color: yellow; font-style: italic; background-color: blue;padding: 2px"),t.map(function(e){return A(e,t)}),e.next=7,Object(_.delay)(o);case 7:i++,e.next=2;break;case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),S=function(e){for(var t=[],n=0;n<e;n++)t.push(ee());return t},M=function(e,t){t.forEach(function(t){t.id===e.id&&(t.chief_age=g(12,45))})},A=function(e,t){if(T(e,t),function(e,t){var n=Math.random()<=e.chief_age/1e3-.3;return n&&(console.log("DEATH: ".concat(e.name,"'s Chief has died")),V("DEATH","".concat(e.name,"'s Chief has died."),[e.id],t)),n}(e,t))!function(e,t){var n=K(e,t),o=g(0,n.length);console.log("DISMANTLE: ".concat(o," communities have decided to leave ").concat(e.name,".")),n.map(function(e,n){n<=o-1&&L(e,t)})}(e,t),M(e,t);else if(null===e.chief){console.log("DECISION: ","The chief polity ".concat(e.name," deliberates")),V("DECISION","The chief polity ".concat(e.name," deliberates"),[e.id],t);var n=I(e,t);n&&W(e,n,t)?G(e,n,null,t):B(e,t)}else{var o=Q(e,t);console.log("DECISION: ","".concat(o.name,"'s subordinate polity ").concat(e.name," deliberates")),R(o,e,t)?D(o,e,t):B(e,t)}return e},I=function(e,t){var n=N(e,t).filter(function(e){return!te(e)}).map(function(e){return Q(e,t)}).sort(function(e,n){return $(e,t)-$(n,t)});return n.length>0&&n[0]},j=function(e,t,n){return[e].concat(Object(c.a)(q(e,n))).reduce(function(e,n){return e+(o=t,i=n,O>=Math.hypot(i.coordinates.x-o.coordinates.x,i.coordinates.y-o.coordinates.y));var o,i},0)},N=function(e,t){return t.filter(function(n){return Q(n,t).id!==e.id&&n.id!==e.id&&j(e,n,t)})},C=function(e,t){var n=[],o=q(e,t).sort(function(e,n){return $(n,t)-$(e,t)});o.length>4&&o.map(function(t,i){i>=4?n.push({chief:o[i-4],target:t}):n.push({chief:e,target:t})}),n.map(function(e){t.forEach(function(t){t.id===e.target.id&&(t.chief=e.chief.id)})})},L=function(e,t){var n=Q(e,t);t.forEach(function(t){t.id===e.id?(console.log("SECESSION: ".concat(t.name," is seceded from ").concat(n.name,".")),t.chief=null):t.id===n.id&&(t.has_incurred_secession=!0)})},T=function(e,t){t.forEach(function(t){t.id===e.id&&(t.has_incurred_secession=!1,t.has_incurred_war=!1,t.chief_age+=1)})},W=function(e,t,n){var o=H(e,t,n),i=z(o);return Math.random()<=P(e,o,i)},R=function(e,t,n){var o=1-H(e,t,n);return Math.random()<=o},D=function(e,t,n){console.log("REBELLION: ","".concat(t.name," attempts rebellion against ").concat(e.name,"."));var o=H(e,t,n);F(1-o)?(console.log("REBELLION: ","".concat(t.name," succeeds.")),J(U(o),[e.id,t.id],n),L(t,n),C(Q(e),n)):(console.log("REBELLION: ","".concat(t.name," fails.")),J(z(o),[e.id,t.id],n))},B=function(e,t){console.log("PEACE: ","".concat(e.name," has peace.")),X(Math.sign(e.baseline_resource_level-e.resource_level)*(e.baseline_resource_level/3),[e.id],t)},G=function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0,r=function(e,t,n){var o=[];return(o=q(t,n).length>0?N(e,n).filter(function(e){return Q(e,n).id===t.id}).sort(function(e,t){return $(t,n)-$(e,n)}):N(e,n).filter(function(e){return e.id===t.id})).length>0&&o[0]}(t,n,i);if(r){console.log("WAR: ","".concat(t.name," prepares for war against ").concat(n.name));var a=H(t,r,i);null===o&&(o=1-a),!F(o)?(console.log("WAR: ","".concat(t.name," succeeds in battle against ").concat(r.name)),J(z(a),[t.id,r.id],i),function(e,t,n){console.log("ANNEX: ","".concat(t.name," is annexed by ").concat(e.name,"."));var o=K(t,n).map(function(e){return e.id});n.forEach(function(n){n.id===t.id&&(n.chief=e.id),o.indexOf(n.id)>-1&&(n.chief=null)})}(t,r,i),C(t,i),o-=.8*o,Q(n,i).id!==t.id&&(console.log("WAR: ","".concat(t.name,"'s onslaught continues against ").concat(n.name)),e(t,n,o,i))):(console.log("WAR: ","".concat(t.name," fails in battle against ").concat(r.name)),J(U(a),[t.id,r.id],i))}else console.log("IMPASSE: ".concat(n.name," has no communities with reach of ").concat(t.name,"'s assualt."))},F=function(e){return Math.random()<=e},H=function(e,t,n){var o=Math.pow($(e,n),2);return o/(o+Math.pow($(t,n),2))},P=function(e,t,n){return t*Math.exp(-2*n)*(e.resource_level/e.baseline_resource_level)},z=function(e){return w*(1-e)},U=function(e){return w*e},J=function(e,t,n){n.forEach(function(n){t.indexOf(n.id)>-1&&(n.resource_level=Math.max(0,n.resource_level-e))})},X=function(e,t,n){n.forEach(function(n){t.indexOf(n.id)>-1&&(n.resource_level+=e)})},$=function(e,t){return K(e,t).reduce(function(e,t){return e+.5*t.resource_level},0)+e.resource_level},q=function(e,t){return t.filter(function(n){return n.id!==e.id&&Q(n,t).id===e.id})},K=function(e,t){return t.filter(function(t){return t.id!==e.id&&t.chief===e.id})},Q=function e(t,n){var o=!1,i=[];return null!==t.chief&&(i=n.filter(function(e){return e.id===t.chief})),i.length>0&&(o=i[0]),o?e(o,n):t},V=function(e,t,n,o){o.forEach(function(o){n.indexOf(o.id)>-1&&(o.events=o.events.concat(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DEFAULT",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{event:Y[e],message:t}}(e,t)))})},Y={DEFAULT:{color:"gray"},DECISION:{color:"green"},WAR:{color:"red"},PEACE:{color:"blue"},SECESSION:{color:"yellow"},ANNEXATION:{color:"orange"},DEATH:{color:"purple"},DISMANTLE:{color:"gray"}},Z=function(e){var t=e.length;return e.map(function(n){return{percent:q(n,e).length/t,polity_id:n.id}})};function ee(){var e=1+g(-1,1)*w;return{id:y()(),name:ie([ne,oe]),baseline_resource_level:e,resource_level:e,chief:null,coordinates:{x:g(0,x),y:g(0,x)},has_incurred_secession:!1,has_incurred_war:!1,chief_age:30,events:[],color:b.a.Util.getRandomColor()}}var te=function(e){return e.has_incurred_secession&&e.has_incurred_war},ne=["Moon","Sun","Black","White","Light","Shadow","Red","Green","Gray","Mighty","Wither","Gale","Hay","Stone","River"],oe=["Fire","Water","Belly","Peaks","Born","Still","Wood","Wine","Run","Guard","Fell","Fall"],ie=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){return(t=e).length>0?t[g(0,t.length-1)]:null;var t}).join(" ")},re=n(5),ae=(i.a.Component,function(e){function t(){var e,n;Object(f.a)(this,t);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(i)))).state={step_distance:100,entity_distance:40,offset_x:160,offset_y:25,previous_polity_power:0,padding_right:20},n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props.all_historical_polities.map(function(e){return{polity:e,points:[]}});return this.props.history.map(function(n,o){n.polities.map(function(i,r){var a=r>0?n.percents.slice(0,r).reduce(function(e,t){return e+t.percent},0):0,s=n.percents.filter(function(e){return e.polity_id===i.id})[0].percent,l=(e.props.width-e.state.offset_x)*(s+a),u=o*e.state.step_distance;t=t.map(function(e){return e.polity.id===i.id&&(e.points=[].concat(Object(c.a)(e.points),[l,u])),e})})}),i.a.createElement(re.Group,null,this.props.polities.map(function(t,n){return i.a.createElement(re.Group,null,i.a.createElement(re.Text,{x:20,y:100+50*n,text:t.name,fill:t.color,fontSize:20}),i.a.createElement(re.Text,{x:20,y:120+50*n,text:Math.round(100*$(t,e.props.polities))/100,fill:t.color,fontSize:20}))}),i.a.createElement(re.Group,{x:this.state.offset_x,y:this.state.offset_y-(100*this.props.history.length>=this.props.height-this.state.offset_y?100*this.props.history.length:0)+this.props.height-100,draggable:!0,dragBoundFunc:function(t){return{x:e.state.offset_x,y:Math.min(e.state.offset_y,t.y)}}},t.map(function(t,n){var o=[];return e.props.history.forEach(function(t,n){n===e.props.history.length-1&&(o=(o=o.concat([0,n*e.state.step_distance])).concat([0,0]))}),i.a.createElement(re.Line,{key:n,x:0,y:0,points:t.points.concat(o),stroke:t.polity.color,tension:0,strokeWidth:4,closed:!0,fill:t.polity.color})}).reverse(),this.props.history.map(function(t,n){return i.a.createElement(re.Line,{key:n,x:0,y:0,points:[0,n*e.state.step_distance,e.props.width+e.state.offset_x,n*e.state.step_distance],stroke:"black",tension:0,strokeWidth:4})})))}}]),t}(i.a.Component)),ce=function(e){function t(){var e;Object(f.a)(this,t),e=Object(d.a)(this,Object(p.a)(t).call(this));var n=S(30),o=Z(n);return e.state={polities:n,all_historical_polities:n,width:window.innerWidth-40,height:window.innerHeight,history:[{polities:n,percents:o}]},e}return Object(m.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.table(this.state.polities),t=0;case 2:if(!(t<200)){e.next=8;break}return e.next=5,this.step(500);case 5:t++,e.next=2;break;case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"step",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,n,o,i,r=arguments;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:0,e.next=3,k(Object(c.a)(this.state.polities),1,t);case 3:n=e.sent,o=Z(n),i=this.state.history.concat({polities:n,percents:o}),this.setState({polities:n,history:i});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return i.a.createElement(re.Stage,{width:this.state.width,height:this.state.width},i.a.createElement(re.Layer,null,i.a.createElement(re.Rect,{x:20,y:20,width:100,height:50,fill:"red",onClick:function(){return e.step()}}),i.a.createElement(re.Text,{x:50,y:40,text:"Step",fill:"black",fontSize:20})),i.a.createElement(re.Layer,null,i.a.createElement(ae,{polities:this.state.polities,all_historical_polities:this.state.all_historical_polities,history:this.state.history,width:this.state.width,height:this.state.height})))}}]),t}(i.a.Component);var se=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(ce,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(i.a.createElement(se,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[41,1,2]]]);
//# sourceMappingURL=main.87f0f498.chunk.js.map